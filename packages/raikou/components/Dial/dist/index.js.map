{"version":3,"sources":["../src/index.ts","../src/Dial.tsx","css-module:./Dial.module.css#css-module"],"sourcesContent":["export { Dial } from \"./Dial\";\nexport type {\n  DialCssVariables,\n  DialFactory,\n  DialProps,\n  DialStylesNames,\n} from \"./Dial\";\n","import React, { useRef } from \"react\";\nimport {\n  Box,\n  BoxProps,\n  StylesApiProps,\n  polymorphicFactory,\n  useProps,\n  useStyles,\n  createVarsResolver,\n  PolymorphicFactory,\n  getSize,\n  RaikouSize,\n} from \"@raikou/core\";\nimport { useMergedRef } from \"@raikou/hooks\";\nimport classes from \"./Dial.module.css\";\n\nexport type DialStylesNames = \"root\" | \"inner\" | \"handle\";\n\nexport type DialCssVariables = {\n  root: \"--dial-size\";\n};\n\nexport interface DialProps extends BoxProps, StylesApiProps<DialFactory> {\n  /** Controls `font-size`, `height` and horizontal `padding`, `'md'` by default */\n  size?: RaikouSize | (string & {});\n\n  scale?: number;\n  value: number;\n  onChange: (value: number) => void;\n}\n\nexport type DialFactory = PolymorphicFactory<{\n  props: DialProps;\n  defaultRef: HTMLDivElement;\n  defaultComponent: \"div\";\n  stylesNames: DialStylesNames;\n  vars: DialCssVariables;\n}>;\n\nconst defaultProps: Partial<DialProps> = {\n  scale: 1,\n};\n\nconst varsResolver = createVarsResolver<DialFactory>(\n  (_, { size, scale, value: angle }) => {\n    return {\n      root: {\n        \"--dial-size\": getSize(size, \"dial-size\"),\n        \"--dial-scale\": scale,\n        \"--dial-angle\": `${angle}deg`,\n      },\n    };\n  },\n);\n\nexport const Dial = polymorphicFactory<DialFactory>((_props, ref) => {\n  const props = useProps(\"Dial\", defaultProps, _props);\n  const {\n    classNames,\n    className,\n    style,\n    styles,\n    unstyled,\n    vars,\n    value,\n    scale,\n    onChange,\n    ...others\n  } = props;\n\n  const getStyles = useStyles<DialFactory>({\n    name: \"Dial\",\n    props,\n    classes,\n    className,\n    style,\n    classNames,\n    styles,\n    unstyled,\n    vars,\n    varsResolver,\n  });\n\n  const dialRef = useRef<HTMLDivElement | null>(null);\n\n  const mergedRef = useMergedRef(dialRef, ref);\n\n  let mouseValues = {\n    wheelCenter: 0,\n    moveX: 0,\n    moveY: 0,\n  };\n\n  const onMouseUp = (e: MouseEvent): void => {\n    removeListeners();\n    onMouseMove(e);\n  };\n\n  const onMouseMove = (e: MouseEvent): void => {\n    const { pageX, pageY } = e;\n    const { moveX, moveY, wheelCenter } = mouseValues;\n    const posX = pageX - moveX - window.scrollX;\n    const posY = pageY - moveY - window.scrollY;\n\n    let value =\n      Math.atan2(posY - wheelCenter, posX - wheelCenter) * (180 / Math.PI) + 90;\n    if (value < 0) value += 360;\n    value = Math.max(0, Math.min(360, Math.round(value)));\n\n    const { onChange } = props;\n    onChange(value);\n  };\n\n  const onMouseDown = (e: React.MouseEvent): void => {\n    e.preventDefault();\n    const div = dialRef.current as HTMLSpanElement;\n    const rect = div.getBoundingClientRect();\n    const { top, left, width } = rect;\n\n    mouseValues = {\n      wheelCenter: width * 0.5 + 5,\n      moveX: left,\n      moveY: top,\n    };\n\n    onMouseMove(e as any);\n\n    document.addEventListener(\"mousemove\", onMouseMove);\n    document.addEventListener(\"mouseleave\", onMouseUp);\n    document.addEventListener(\"mouseup\", onMouseUp);\n  };\n\n  const removeListeners = () => {\n    document.removeEventListener(\"mousemove\", onMouseMove);\n    document.removeEventListener(\"mouseleave\", onMouseUp);\n    document.removeEventListener(\"mouseup\", onMouseUp);\n  };\n\n  return (\n    <Box\n      component=\"span\"\n      ref={mergedRef}\n      {...getStyles(\"root\")}\n      onMouseDown={onMouseDown}\n      onKeyDown={() => {}}\n      role=\"button\"\n      tabIndex={0}\n      {...others}\n    >\n      <Box component=\"span\" {...getStyles(\"inner\")}>\n        <Box component=\"span\" {...getStyles(\"handle\")} />\n      </Box>\n    </Box>\n  );\n});\n\nDial.displayName = \"@raikou/Dial\";\nDial.classes = classes;\n","import \"/Users/paul/development/src/github/raikou/packages/raikou/components/Dial/src/Dial.module.css\"; export default {\"root\":\"m-43c05cff\",\"inner\":\"m-33cbf5d9\",\"handle\":\"m-4346b705\"}"],"mappings":"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","names":["value","onChange","React"]}